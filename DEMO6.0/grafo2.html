<!DOCTYPE html>
<html>
<head>
    <title>Grafo con nodi e archi orientati</title>
    <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
    <style>
        #cy {
            width: 100%;
            height: 500px;
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>
    <div id="cy"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var json = {
  "nodes": [
    {
      "data": {
        "id": "1",
        "label": "1",
        "justified": "green"
      }
    },
    {
      "data": {
        "id": "2",
        "label": "2",
        "justified": "red"
      }
    },
    {
      "data": {
        "id": "3",
        "label": "3",
        "justified": "green"
      }
    },
    {
      "data": {
        "id": "4",
        "label": "4",
        "justified": "green"
      }
    },
    {
      "data": {
        "id": "5",
        "label": "5",
        "justified": "red"
      }
    },
    {
      "data": {
        "id": "6",
        "label": "6",
        "justified": "green"
      }
    },
    {
      "data": {
        "id": "7",
        "label": "7",
        "justified": "green"
      }
    },
    {
      "data": {
        "id": "8",
        "label": "8",
        "justified": "red"
      }
    },
    {
      "data": {
        "id": "9",
        "label": "9",
        "justified": "red"
      }
    },
    {
      "data": {
        "id": "10",
        "label": "10",
        "justified": "red"
      }
    },
    {
      "data": {
        "id": "12",
        "label": "12",
        "justified": "green"
      }
    },
    {
      "data": {
        "id": "13",
        "label": "13",
        "justified": "red"
      }
    },
    {
      "data": {
        "id": "14",
        "label": "14",
        "justified": "red"
      }
    },
    {
      "data": {
        "id": "15",
        "label": "15",
        "justified": "red"
      }
    },
    {
      "data": {
        "id": "16",
        "label": "16",
        "justified": "red"
      }
    },
    {
      "data": {
        "id": "11",
        "label": "11",
        "justified": "red"
      }
    }
  ],
  "edges": [
    {
      "data": {
        "id": "12",
        "source": "1",
        "target": "2",
        "color": "red",
        "weight": -1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "110",
        "source": "1",
        "target": "10",
        "color": "red",
        "weight": -1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "114",
        "source": "1",
        "target": "14",
        "color": "red",
        "weight": -1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "116",
        "source": "1",
        "target": "16",
        "color": "red",
        "weight": -1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "111",
        "source": "1",
        "target": "11",
        "color": "red",
        "weight": -1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "21",
        "source": "2",
        "target": "1",
        "color": "red",
        "weight": -1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "32",
        "source": "3",
        "target": "2",
        "color": "green",
        "weight": 1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "41",
        "source": "4",
        "target": "1",
        "color": "green",
        "weight": 1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "54",
        "source": "5",
        "target": "4",
        "color": "green",
        "weight": 1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "61",
        "source": "6",
        "target": "1",
        "color": "green",
        "weight": 1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "68",
        "source": "6",
        "target": "8",
        "color": "red",
        "weight": -1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "76",
        "source": "7",
        "target": "6",
        "color": "green",
        "weight": 1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "86",
        "source": "8",
        "target": "6",
        "color": "red",
        "weight": -1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "98",
        "source": "9",
        "target": "8",
        "color": "green",
        "weight": 1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "101",
        "source": "10",
        "target": "1",
        "color": "red",
        "weight": 1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "1211",
        "source": "12",
        "target": "11",
        "color": "red",
        "weight": -1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "1312",
        "source": "13",
        "target": "12",
        "color": "green",
        "weight": 1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "141",
        "source": "14",
        "target": "1",
        "color": "red",
        "weight": 1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "1511",
        "source": "15",
        "target": "11",
        "color": "green",
        "weight": 1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "161",
        "source": "16",
        "target": "1",
        "color": "red",
        "weight": 1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "111",
        "source": "11",
        "target": "1",
        "color": "red",
        "weight": -1,
        "directed": true
      }
    },
    {
      "data": {
        "id": "1112",
        "source": "11",
        "target": "12",
        "color": "red",
        "weight": -1,
        "directed": true
      }
    }
  ]
};

            var cy = cytoscape({
                container: document.getElementById('cy'),
                elements: json,
                style: [
                    {
                        selector: 'node',
                        style: {
                            'label': 'data(label)',
                            'background-color': 'data(justified)',
                            'width': '30px',
                            'height': '30px',
                            'border-color': '#000',
                            'border-width': '2px',
                            'border-opacity': '1',
                            'text-valign': 'center',
                            'color': '#fff',
                            'text-outline-color': '#000',
                            'text-outline-width': '1px',
                            'text-outline-opacity': '1',
                            'content': 'data(id)',
                            'text-wrap': 'wrap',
                            'text-max-width': '20px',
                            'text-justification': 'center'
                        }
                    },
                    {
                        selector: 'edge',
                        style: {
                            'width': 2,
                            'line-color': 'data(color)',
                            'target-arrow-color': 'data(color)',
                            'target-arrow-shape': 'triangle'
                        }
                    }
                ],
                layout: {
                    name: 'random'
                }
            });

            cy.on('free', 'node', function (event) {
                var node = event.target;
                var position = node.position();

                // Aggiorna le coordinate del nodo nel JSON
                json.nodes.find(function (n) {
                    return n.data.id === node.id();
                }).position = {
                    x: position.x,
                    y: position.y
                };
            });

            cy.on('tap', function (event) {
                if (event.target === cy) {
                    // Deseleziona il nodo quando si fa clic sulla casella
                    cy.$('node:selected').unselect();
                }
            });
        });
    </script>
</body>
</html>
